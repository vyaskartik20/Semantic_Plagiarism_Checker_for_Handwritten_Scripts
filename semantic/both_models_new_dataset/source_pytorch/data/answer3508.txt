New Zealand set to legalise gay marriage